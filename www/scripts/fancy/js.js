(function(){var e;e=window.jQuery||window.Zepto||window.$,e.fn.fancySelect=function(n){var t,a;return null==n&&(n={}),a=e.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(e){return e.text()},triggerTemplate:function(e){return e.text()}},n),t=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var n,r,s,i,o,l,d;return i=e(this),i.hasClass("fancified")||"SELECT"!==i[0].tagName?void 0:(i.addClass("fancified"),i.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),i.wrap('<div class="fancy-select">'),d=i.parent(),i.data("class")&&d.addClass(i.data("class")),d.append('<div class="trigger">'),(!t||a.forceiOS)&&d.append('<ul class="options">'),o=d.find(".trigger"),s=d.find(".options"),r=i.prop("disabled"),r&&d.addClass("disabled"),l=function(){var e;return e=a.triggerTemplate(i.find(":selected")),o.html(e)},i.on("blur.fs",function(){return o.hasClass("open")?setTimeout(function(){return o.trigger("close.fs")},120):void 0}),o.on("close.fs",function(){return o.removeClass("open"),s.removeClass("open")}),o.on("click.fs",function(){var n,l;if(!r)if(o.toggleClass("open"),t&&!a.forceiOS){if(o.hasClass("open"))return i.focus()}else if(o.hasClass("open")&&(l=o.parent(),n=l.offsetParent(),l.offset().top+l.outerHeight()+s.outerHeight()+20>e(window).height()+e(window).scrollTop()?s.addClass("overflowing"):s.removeClass("overflowing")),s.toggleClass("open"),!t)return i.focus()}),i.on("enable",function(){return i.prop("disabled",!1),d.removeClass("disabled"),r=!1,n()}),i.on("disable",function(){return i.prop("disabled",!0),d.addClass("disabled"),r=!0}),i.on("change.fs",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():l()}),i.on("keydown",function(e){var n,t,a;if(a=e.which,n=s.find(".hover"),n.removeClass("hover"),s.hasClass("open")){if(38===a?(e.preventDefault(),n.length&&n.index()>0?n.prev().addClass("hover"):s.find("li:last-child").addClass("hover")):40===a?(e.preventDefault(),n.length&&n.index()<s.find("li").length-1?n.next().addClass("hover"):s.find("li:first-child").addClass("hover")):27===a?(e.preventDefault(),o.trigger("click.fs")):13===a||32===a?(e.preventDefault(),n.trigger("mousedown.fs")):9===a&&o.hasClass("open")&&o.trigger("close.fs"),t=s.find(".hover"),t.length)return s.scrollTop(0),s.scrollTop(t.position().top-12)}else if(13===a||32===a||38===a||40===a)return e.preventDefault(),o.trigger("click.fs")}),s.on("mousedown.fs","li",function(n){var a;return a=e(this),i.val(a.data("raw-value")),t||i.trigger("blur.fs").trigger("focus.fs"),s.find(".selected").removeClass("selected"),a.addClass("selected"),o.addClass("selected"),i.val(a.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),s.on("mouseenter.fs","li",function(){var n,t;return t=e(this),n=s.find(".hover"),n.removeClass("hover"),t.addClass("hover")}),s.on("mouseleave.fs","li",function(){return s.find(".hover").removeClass("hover")}),n=function(){var n;return l(),!t||a.forceiOS?(n=i.find("option"),i.find("option").each(function(n,t){var r;return t=e(t),t.prop("disabled")||!t.val()&&!a.includeBlank?void 0:(r=a.optionTemplate(t),t.prop("selected")?s.append('<li data-raw-id="'+t.attr("id")+'" data-raw-value="'+t.val()+'" data-raw-parent="'+t.attr("province")+'" class="selected">'+r+"</li>"):s.append('<li data-raw-id="'+t.attr("id")+'" data-raw-value="'+t.val()+'" data-raw-parent="'+t.attr("province")+'">'+r+"</li>"))})):void 0},i.on("update.fs",function(){return d.find(".options").empty(),n()}),n())})}}).call(this);